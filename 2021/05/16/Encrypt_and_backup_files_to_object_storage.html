<!DOCTYPE html> <html lang="en"><head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"><title>Encrypt and backup personal files to an object storage</title><!-- Begin Jekyll SEO tag v2.6.1 --> <meta name="generator" content="Jekyll v3.8.7" /> <meta property="og:title" content="Encrypt and backup personal files to an object storage" /> <meta name="author" content="Nitish Jadia" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="I feel that cloud backups are expensive, look at Dropbox, Google Drive, OneDrive, etc. BlackBlaze B2, seems to be a good for long term backups where you upload and forget, download only when we are required. It’s important to have your personal files encrypted when stored on the cloud, you never know about another iCloud hack." /> <meta property="og:description" content="I feel that cloud backups are expensive, look at Dropbox, Google Drive, OneDrive, etc. BlackBlaze B2, seems to be a good for long term backups where you upload and forget, download only when we are required. It’s important to have your personal files encrypted when stored on the cloud, you never know about another iCloud hack." /> <link rel="canonical" href="https://jadia.dev/2021/05/16/Encrypt_and_backup_files_to_object_storage" /> <meta property="og:url" content="https://jadia.dev/2021/05/16/Encrypt_and_backup_files_to_object_storage" /> <meta property="og:site_name" content="Nitish Jadia" /> <meta property="og:image" content="https://jadia.dev/assets/social-devops-python-preview.png" /> <meta property="og:image:height" content="628" /> <meta property="og:image:width" content="1200" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2021-05-16T14:51:00+00:00" /> <meta name="twitter:card" content="summary_large_image" /> <meta property="twitter:image" content="https://jadia.dev/assets/social-devops-python-preview.png" /> <meta property="twitter:title" content="Encrypt and backup personal files to an object storage" /> <meta name="twitter:site" content="@nitishjadia" /> <meta name="twitter:creator" content="@nitishjadia" /> <script type="application/ld+json"> {"description":"I feel that cloud backups are expensive, look at Dropbox, Google Drive, OneDrive, etc. BlackBlaze B2, seems to be a good for long term backups where you upload and forget, download only when we are required. It’s important to have your personal files encrypted when stored on the cloud, you never know about another iCloud hack.","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://jadia.dev/assets/ms-icon-310x310.png"},"name":"Nitish Jadia"},"url":"https://jadia.dev/2021/05/16/Encrypt_and_backup_files_to_object_storage","@type":"BlogPosting","image":{"width":1200,"height":628,"url":"https://jadia.dev/assets/social-devops-python-preview.png","@type":"imageObject"},"headline":"Encrypt and backup personal files to an object storage","dateModified":"2021-05-16T14:51:00+00:00","datePublished":"2021-05-16T14:51:00+00:00","author":{"@type":"Person","name":"Nitish Jadia"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://jadia.dev/2021/05/16/Encrypt_and_backup_files_to_object_storage"},"@context":"https://schema.org"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="/assets/main.css"><link rel="apple-touch-icon" sizes="57x57" href="/assets/apple-icon-57x57.png"> <link rel="apple-touch-icon" sizes="60x60" href="/assets/apple-icon-60x60.png"> <link rel="apple-touch-icon" sizes="72x72" href="/assets/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="76x76" href="/assets/apple-icon-76x76.png"> <link rel="apple-touch-icon" sizes="114x114" href="/assets/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="120x120" href="/assets/apple-icon-120x120.png"> <link rel="apple-touch-icon" sizes="144x144" href="/assets/apple-icon-144x144.png"> <link rel="apple-touch-icon" sizes="152x152" href="/assets/apple-icon-152x152.png"> <link rel="apple-touch-icon" sizes="180x180" href="/assets/apple-icon-180x180.png"> <link rel="icon" type="image/png" sizes="192x192" href="/assets/android-icon-192x192.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="96x96" href="/assets/favicon-96x96.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"> <link rel="manifest" href="/assets/manifest.json"> <meta name="msapplication-TileColor" content="#ffffff"> <meta name="msapplication-TileImage" content="/ms-icon-144x144.png"> <meta name="theme-color" content="#ffffff"> <!-- Old diamantidis.github.io favicon entires --> <!-- <link rel="apple-touch-icon" href="/assets/apple-touch-icon.png"/> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"> <link rel="manifest" href="/assets/site.webmanifest"> <link rel="mask-icon" href="assets/safari-pinned-tab.svg" color="#5bbad5"> <link rel="shortcut icon" href="/assets/favicon.ico"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="msapplication-config" content="/assets/browserconfig.xml"> <meta name="theme-color" content="#ffffff"> --><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"><link type="application/atom+xml" rel="alternate" href="https://jadia.dev/feed.xml" title="Nitish Jadia" /><script> if(!(window.doNotTrack === "1" || navigator.doNotTrack === "1" || navigator.doNotTrack === "yes" || navigator.msDoNotTrack === "1")) { (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-61932410-4', 'auto'); ga('send', 'pageview'); ga('set', 'anonymizeIp', true); } </script> </head> <body><header class="site-header" role="banner"> <div class="wrapper"><div class="left-container"> <div class="title-wrapper"> <a class="site-title" rel="author" href="/"> <h1>Nitish Jadia</h1> </a> </div> <div class="footer-icons"> <ul> <li> <div class="social-icon"> <a href="https://twitter.com/nitishjadia" aria-label="Twitter"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="https://github.com/jadia" aria-label="GitHub"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="http://linkedin.com/in/jadianitish" aria-label="LinkedIn"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="/feed.xml" aria-label="RSS Feed"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-rss fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="mailto:nitish@jadia.dev" aria-label="Email"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-envelope fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> </ul> </div> </div><nav class="site-nav"> <input type="checkbox" id="nav-trigger" class="nav-trigger" /> <label for="nav-trigger"> <span class="menu-icon"> <svg viewBox="0 0 18 15" width="18px" height="15px"> <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" /> </svg> </span> </label> <div class="trigger"> <a class="page-link" href="/til" title="Today I Learned">Today I Learned</a> <a class="page-link" href="/howto" title="How To">How To</a> <a class="page-link" href="/uses" title="Uses">Uses</a><a class="page-link" href="/about" title="About">About</a><a class="page-link" href="/archive" title="Archive">Archive</a><a class="page-link" href="/tags" title="Tags">Tags</a></div> </nav></div> </header><main class="page-content" aria-label="Content"> <div class="wrapper"> <article class="post"> <header class="post-header"> <h1> <span class="post-title">Encrypt and backup personal files to an object storage</span> </h1> <div class="post-subheader"> <span class="post-date"> May 16, 2021 </span> <span class="post-divider">-</span> <span class="post-minutes"> 2 min read </span> <div class="outer-post-tags"> <div class="post-tags"> <a class="post-tag" href="/tags#Linux" title="Linux">Linux</a> </div> </div> </div> </header> <div class="post-content"> <p>I feel that cloud backups are expensive, look at Dropbox, Google Drive, OneDrive, etc. BlackBlaze B2, <em>seems</em> to be a good for long term backups where you upload and forget, download only when we are required.<br /> It’s important to have your personal files encrypted when stored on the cloud, you never know about another <a href="https://en.wikipedia.org/wiki/ICloud_leaks_of_celebrity_photos">iCloud hack</a>.</p> <h4 id="install-gocryptfs-and-rclone">Install GocryptFS and rClone</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt <span class="nb">install</span> <span class="nt">-y</span> gocryptfs
curl https://rclone.org/install.sh | <span class="nb">sudo </span>bash
</code></pre></div></div> <h4 id="set-up-object-storage">Set up object storage</h4> <p>Register at <a href="https://www.backblaze.com/b2/cloud-storage.html">https://www.backblaze.com/b2/cloud-storage.html</a>. Make sure to read the <a href="https://www.backblaze.com/b2/cloud-storage-pricing.html">pricing details</a> and your <a href="https://secure.backblaze.com/b2_caps_alerts.htm">usage statistic</a>.</p> <p>Use <code class="language-plaintext highlighter-rouge">rclone config</code> to configure B2 object storage. Follow this guide: <a href="https://rclone.org/b2/">https://rclone.org/b2/</a>.</p> <p><img src="/assets/posts/2021-05-16-Encrypt_and_backup_files_to_object_storage/2021-05-16-22-04-41.png" alt="rclone config" /></p> <p>Go to Blackblaze B2 website and click on <strong>App keys</strong> and generate a new set of keys for rclone. <img src="/assets/posts/2021-05-16-Encrypt_and_backup_files_to_object_storage/2021-05-16-22-07-10.png" alt="" /></p> <p>Add a new Application Key and copy the key ID and set it up in rclone.</p> <p><img src="/assets/posts/2021-05-16-Encrypt_and_backup_files_to_object_storage/2021-05-16-22-07-48.png" alt="" /> <img src="/assets/posts/2021-05-16-Encrypt_and_backup_files_to_object_storage/2021-05-16-22-34-18.png" alt="" /></p> <p>The name of the remote is <code class="language-plaintext highlighter-rouge">b2-backup</code>. I can use this name to connect with the Blackblaze server and perform operations like <em>sync</em>, <em>dir list</em>, etc.</p> <p>Create a new bucket using the following command:</p> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rclone <span class="nb">mkdir </span>b2-backup:photo-bucket
</code></pre></div></div> <p>Make sure to use <code class="language-plaintext highlighter-rouge">-</code> instead of <code class="language-plaintext highlighter-rouge">_</code> for the bucket name.</p> <h4 id="create-a-folder-to-store-encrypted-files">Create a folder to store encrypted files</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>backup-crypt
gocryptfs <span class="nt">-init</span> <span class="nt">-plaintextnames</span> backup-crypt

<span class="c"># -plaintextnames : Do not encrypt the names of the files and folder</span>
<span class="c">#                   this helps when we are trying to recover lost files</span>
<span class="c">#                   Skip this option if you wish to hide the names of files</span>
</code></pre></div></div> <p><strong>Make sure to store the keys properly</strong></p> <h4 id="mount-the-encrypted-files">Mount the encrypted files</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">mkdir </span>private
gocryptfs backup-crypt private
</code></pre></div></div> <p>Copy and paste files in the <code class="language-plaintext highlighter-rouge">private</code> directory and the encrypted counter part will be reflected in the <code class="language-plaintext highlighter-rouge">backup-crypt</code> directory.</p> <h4 id="sync-encrypted-files">Sync encrypted files</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>rclone <span class="nb">sync</span> <span class="nt">--progress</span> backup-crypt/ b2-backup:photo-bucket
</code></pre></div></div> <h4 id="unmount-the-private-directory-and-stay-safe-">Unmount the <code class="language-plaintext highlighter-rouge">private</code> directory and stay safe 🔒</h4> <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>fusermount <span class="nt">-u</span> private
</code></pre></div></div> <p>Just make sure that you keep eye on the free limits. You can try to do a small sync everyday to save money on the transfer cost.</p> <p><img src="/assets/posts/2021-05-16-Encrypt_and_backup_files_to_object_storage/2021-05-16-23-17-53.png" alt="" /></p> <h2 id="references">References</h2> <ol> <li><a href="https://defuse.ca/downloads/audits/gocryptfs-cryptography-design-audit.pdf">Gocryptfs security audit</a></li> </ol> </div> <div class="share"> <strong>Share: </strong> <a href="//twitter.com/share?text=Encrypt+and+backup+personal+files+to+an+object+storage&url=https%3A%2F%2Fjadia.dev%2F2021%2F05%2F16%2FEncrypt_and_backup_files_to_object_storage" aria-label="Share on Twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i> </span> </a> <a href="//www.facebook.com/sharer.php?t=Encrypt+and+backup+personal+files+to+an+object+storage&u=https%3A%2F%2Fjadia.dev%2F2021%2F05%2F16%2FEncrypt_and_backup_files_to_object_storage" aria-label="Share on Facebook" onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-facebook fa-stack-1x fa-inverse"></i> </span> </a> <a href="//www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fjadia.dev%2F2021%2F05%2F16%2FEncrypt_and_backup_files_to_object_storage" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i> </span> </a> </div><div id="disqus_thread"></div> <script> var disqus_config = function () { this.page.url = 'https://jadia.dev/2021/05/16/Encrypt_and_backup_files_to_object_storage'; this.page.identifier = 'https://jadia.dev/2021/05/16/Encrypt_and_backup_files_to_object_storage'; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://jadia-dev.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript></article> </div> </main><footer class="site-footer"> <data class="u-url" href="/"></data> <div class="footer-icons"> <ul> <li> <div class="social-icon"> <a href="https://twitter.com/nitishjadia" aria-label="Twitter"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="https://github.com/jadia" aria-label="GitHub"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="http://linkedin.com/in/jadianitish" aria-label="LinkedIn"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="/feed.xml" aria-label="RSS Feed"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-rss fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="mailto:nitish@jadia.dev" aria-label="Email"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-envelope fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> </ul> </div> <div class="wrapper"> <p>Built with <i class="fa fa-heart" aria-hidden="true"></i>, <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://pages.github.com/"> Github Pages</a> </p> <p> © Copyright 2021 Nitish Jadia </p> </div> </footer></body> </html>
